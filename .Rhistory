83*6
83*
83*4+84*2
z_before<-c(rep(1,times=83),rep(2,times=83),rep(3,times=83),
rep(4,times=83),rep(5,times=84),rep(6,times=84))
#z_before[10:15]<-2
#z_before[45:50]<-3
#z_before[80:85]<-1
# write.csv(file="z_before.csv",z_before,row.names = FALSE)
write.table(z_before,file="z_before.csv",sep=",",col.names=FALSE,row.names = FALSE)
par(mfrow=c(1,1))
#plot(y~x,pch=col=c(rep(1,times=33),rep(2,times=33),rep(3,times=34)),main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Before MCMC")
abline(m1)
abline(m2,col=2)
abline(m3,col=3)
###Results after MCMC###
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:3]))
gammas<-as.numeric(unlist(coefs[,4:5]))
sigmas<-exp(logsigma_sqs)
abline(m4,col=4)
abline(m5,col=5)
abline(m6,col=6)
data<-read.csv("data_sin2.csv")
y<-data[,1]
X<-data[,2:3]
x<-data[,3]
m1<-lm(y[1:83]~x[1:83])
m2<-lm(y[84:167]~x[84:167])
m3<-lm(y[168:250]~x[168:250])
m4<-lm(y[251:333]~x[251:333])
m5<-lm(y[334:416]~x[334:416])
m6<-lm(y[417:500]~x[417:500])
z_before<-c(rep(1,times=83),rep(2,times=83),rep(3,times=83),
rep(4,times=83),rep(5,times=84),rep(6,times=84))
write.table(z_before,file="z_before.csv",sep=",",col.names=FALSE,row.names = FALSE)
par(mfrow=c(1,1))
#plot(y~x,pch=col=c(rep(1,times=33),rep(2,times=33),rep(3,times=34)),main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Before MCMC")
abline(m1)
abline(m2,col=2)
abline(m3,col=3)
abline(m4,col=4)
abline(m5,col=5)
abline(m6,col=6)
###Results after MCMC###
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:9]))
gammas<-as.numeric(unlist(coefs[,10:11]))
sigmas<-exp(logsigma_sqs)
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
P<-read.csv("P.csv",header=FALSE)
x_new<-read.csv("x_new.csv",header=FALSE)
betas
betas_mat<-as.matrix(betas,ncol=2)
betas_mat
betas_mat<-as.matrix(betas,ncol=2,nrow=6)
betas_mat
betas
betas_mat<-matrix(betas,ncol=2,nrow=6)
betas_mat
betas
betas_mat<-matrix(betas,ncol=2,nrow=6,byrow=TRUE)
betas_mat
sigmas
plot(y~x,col=z_after,pch=20,main="After MCMC")
for(i in 1:nrow(betas_mat)){
lines(x, betas_mat[1]+betas_mat[2]*x)
lines(x, betas_mat[1]+betas_mat[2]*x+2*sqrt(sigmas[1]),lty=2)
lines(x, betas_mat[1]+betas_mat[2]*x-2*sqrt(sigmas[1]),lty=2)
}
par(mfrow=c(1,1))
plot(x_new[,2],P[nrow(P),],main="Predictions",ylab="Predicted value",xlab="x new")
par(mfrow=c(1,2))
plot(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x)),type="l",main="Gate 1",ylab="pi")
plot(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x)),type="l",main="Gate 2",ylab="pi")
par(mfrow=c(1,1))
plot(y~x,col=z_after,pch=20,main="After MCMC")
for(i in 1:nrow(betas_mat)){
lines(x, betas_mat[i,1]+betas_mat[i,2]*x,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x+2*sqrt(sigmas[i]),lty=2,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x-2*sqrt(sigmas[i]),lty=2,col=i)
}
500/4
z_before<-c(rep(1,times=125),rep(2,times=125),
rep(3,times=125),rep(4,times=125))
write.table(z_before,file="z_before.csv",sep=",",col.names=FALSE,row.names = FALSE)
par(mfrow=c(1,1))
#plot(y~x,pch=col=c(rep(1,times=33),rep(2,times=33),rep(3,times=34)),main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Estimates by R")
250+125
m1<-lm(y[1:125]~x[1:125])
m2<-lm(y[126:250]~x[126:250])
m3<-lm(y[251:375]~x[251:375])
m4<-lm(y[376:500]~x[376:500])
abline(m1)
abline(m2,col=2)
abline(m3,col=3)
abline(m4,col=4)
z_before<-c(rep(1,times=100),rep(2,times=150),
rep(3,times=125),rep(4,times=125))
pch
#plot(y~x,pch=col=c(rep(1,times=33),rep(2,times=33),rep(3,times=34)),main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Estimates by R")
z_before<-c(rep(1,times=90),rep(2,times=160),
rep(3,times=125),rep(4,times=125))
#plot(y~x,pch=col=c(rep(1,times=33),rep(2,times=33),rep(3,times=34)),main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Estimates by R")
z_before<-c(rep(1,times=90),rep(2,times=160),
rep(3,times=150),rep(4,times=100))
par(mfrow=c(1,1))
#plot(y~x,pch=col=c(rep(1,times=33),rep(2,times=33),rep(3,times=34)),main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Estimates by R")
z_before<-c(rep(1,times=90),rep(2,times=160),
rep(3,times=160),rep(4,times=90))
par(mfrow=c(1,1))
#plot(y~x,pch=col=c(rep(1,times=33),rep(2,times=33),rep(3,times=34)),main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Estimates by R")
90+160
250+160
m1<-lm(y[1:90]~x[1:90])
m2<-lm(y[91:250]~x[91:250])
m3<-lm(y[251:410]~x[251:410])
m4<-lm(y[411:500]~x[411:500])
z_before<-c(rep(1,times=83),rep(2,times=83),rep(3,times=83),
rep(4,times=83),rep(5,times=84),rep(6,times=84))
z_before<-c(rep(1,times=90),rep(2,times=160),
rep(3,times=160),rep(4,times=90))
par(mfrow=c(1,1))
#plot(y~x,pch=col=c(rep(1,times=33),rep(2,times=33),rep(3,times=34)),main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Before MCMC")
abline(m1)
abline(m2,col=2)
abline(m3,col=3)
abline(m4,col=4)
write.table(z_before,file="z_before.csv",sep=",",col.names=FALSE,row.names = FALSE)
par(mfrow=c(1,1))
#plot(y~x,pch=col=c(rep(1,times=33),rep(2,times=33),rep(3,times=34)),main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Before MCMC")
abline(m1)
abline(m2,col=2)
abline(m3,col=3)
abline(m4,col=4)
abline(m5,col=5)
setwd("C:/Users/Ivona Voroneckaja/Desktop/MoE/MoE")
data<-read.csv("data_sin2.csv")
y<-data[,1]
X<-data[,2:3]
x<-data[,3]
m1<-lm(y[1:83]~x[1:83])
m2<-lm(y[84:167]~x[84:167])
m3<-lm(y[168:250]~x[168:250])
m4<-lm(y[251:333]~x[251:333])
m5<-lm(y[334:416]~x[334:416])
m6<-lm(y[417:500]~x[417:500])
m1<-lm(y[1:125]~x[1:125])
m2<-lm(y[126:250]~x[126:250])
m3<-lm(y[251:375]~x[251:375])
m4<-lm(y[376:500]~x[376:500])
m1<-lm(y[1:90]~x[1:90])
m2<-lm(y[91:250]~x[91:250])
m3<-lm(y[251:410]~x[251:410])
m4<-lm(y[411:500]~x[411:500])
z_before<-c(rep(1,times=83),rep(2,times=83),rep(3,times=83),
rep(4,times=83),rep(5,times=84),rep(6,times=84))
z_before<-c(rep(1,times=90),rep(2,times=160),
rep(3,times=160),rep(4,times=90))
write.table(z_before,file="z_before.csv",sep=",",col.names=FALSE,row.names = FALSE)
par(mfrow=c(1,1))
#plot(y~x,pch=col=c(rep(1,times=33),rep(2,times=33),rep(3,times=34)),main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Before MCMC")
abline(m1)
abline(m2,col=2)
abline(m3,col=3)
abline(m4,col=4)
#abline(m5,col=5)
#abline(m6,col=6)
###Results after MCMC###
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:9]))
gammas<-as.numeric(unlist(coefs[,10:11]))
sigmas<-exp(logsigma_sqs)
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
P<-read.csv("P.csv",header=FALSE)
x_new<-read.csv("x_new.csv",header=FALSE)
betas_mat<-matrix(betas,ncol=2,nrow=6,byrow=TRUE)
par(mfrow=c(1,1))
plot(y~x,col=z_after,pch=20,main="After MCMC")
for(i in 1:nrow(betas_mat)){
lines(x, betas_mat[i,1]+betas_mat[i,2]*x,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x+2*sqrt(sigmas[i]),lty=2,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x-2*sqrt(sigmas[i]),lty=2,col=i)
}
par(mfrow=c(1,1))
plot(x_new[,2],P[nrow(P),],main="Predictions",ylab="Predicted value",xlab="x new")
par(mfrow=c(1,2))
plot(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x)),type="l",main="Gate 1",ylab="pi")
plot(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x)),type="l",main="Gate 2",ylab="pi")
plot(x,exp(gammas[5]+gammas[6]*x)/(1+exp(gammas[5]+gammas[6]*x)),type="l",main="Gate 2",ylab="pi")
gammas
coefs
###Results after MCMC###
coefs<-read.csv("coefs.csv",header = FALSE)
coefs
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:4]))
gammas<-as.numeric(unlist(coefs[,5:7]))
sigmas<-exp(logsigma_sqs)
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
P<-read.csv("P.csv",header=FALSE)
x_new<-read.csv("x_new.csv",header=FALSE)
betas_mat<-matrix(betas,ncol=2,nrow=6,byrow=TRUE)
par(mfrow=c(1,1))
plot(y~x,col=z_after,pch=20,main="After MCMC")
for(i in 1:nrow(betas_mat)){
lines(x, betas_mat[i,1]+betas_mat[i,2]*x,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x+2*sqrt(sigmas[i]),lty=2,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x-2*sqrt(sigmas[i]),lty=2,col=i)
}
par(mfrow=c(1,1))
plot(x_new[,2],P[nrow(P),],main="Predictions",ylab="Predicted value",xlab="x new")
par(mfrow=c(1,2))
plot(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x)),type="l",main="Gate 1",ylab="pi")
plot(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x)),type="l",main="Gate 2",ylab="pi")
plot(x,exp(gammas[5]+gammas[6]*x)/(1+exp(gammas[5]+gammas[6]*x)),type="l",main="Gate 2",ylab="pi")
plot(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x)),type="l",main="Gate 1",ylab="pi")
par(mfrow=c(1,1))
plot(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x)),type="l",main="Gate 1",ylab="pi")
plot(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x)),type="l",main="Gate 2",ylab="pi")
plot(x,exp(gammas[5]+gammas[6]*x)/(1+exp(gammas[5]+gammas[6]*x)),type="l",main="Gate 3",ylab="pi")
x<-seq(from=-5,to=15,length.out = 500)
y<-sin(x)
y<-y+rnorm(n = 100,mean = 0,sd = 0.4)
par(mfrow=c(1,1))
plot(x,y)
write.table(cbind(y,1,x),file="data_sin3.csv",sep=",",col.names=FALSE,row.names = FALSE)
x_new<-cbind(1,seq(from=-5,to=15,length.out = 500))
write.table(x_new,file="x_new.csv",sep=",",col.names=FALSE,row.names = FALSE)
data<-read.csv("data_sin3.csv")
y<-data[,1]
X<-data[,2:3]
x<-data[,3]
m1<-lm(y[1:83]~x[1:83])
m2<-lm(y[84:167]~x[84:167])
m3<-lm(y[168:250]~x[168:250])
m4<-lm(y[251:333]~x[251:333])
m5<-lm(y[334:416]~x[334:416])
m6<-lm(y[417:500]~x[417:500])
z_before<-c(rep(1,times=83),rep(2,times=83),rep(3,times=83),
rep(4,times=83),rep(5,times=84),rep(6,times=84))
write.table(z_before,file="z_before.csv",sep=",",col.names=FALSE,row.names = FALSE)
par(mfrow=c(1,1))
#plot(y~x,pch=col=c(rep(1,times=33),rep(2,times=33),rep(3,times=34)),main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Before MCMC")
abline(m1)
abline(m2,col=2)
abline(m3,col=3)
abline(m4,col=4)
abline(m5,col=5)
abline(m6,col=6)
write.table(z_before,file="z_before.csv",sep=",",col.names=FALSE,row.names = FALSE)
z_before
###Results after MCMC###
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:6]))
gammas<-as.numeric(unlist(coefs[,7:11]))
sigmas<-exp(logsigma_sqs)
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
P<-read.csv("P.csv",header=FALSE)
x_new<-read.csv("x_new.csv",header=FALSE)
betas_mat<-matrix(betas,ncol=2,nrow=6,byrow=TRUE)
par(mfrow=c(1,1))
plot(y~x,col=z_after,pch=20,main="After MCMC")
for(i in 1:nrow(betas_mat)){
lines(x, betas_mat[i,1]+betas_mat[i,2]*x,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x+2*sqrt(sigmas[i]),lty=2,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x-2*sqrt(sigmas[i]),lty=2,col=i)
}
par(mfrow=c(1,1))
plot(x_new[,2],P[nrow(P),],main="Predictions",ylab="Predicted value",xlab="x new")
par(mfrow=c(1,1))
plot(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x)),type="l",main="Gate 1",ylab="pi")
plot(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x)),type="l",main="Gate 2",ylab="pi")
plot(x,exp(gammas[5]+gammas[6]*x)/(1+exp(gammas[5]+gammas[6]*x)),type="l",main="Gate 3",ylab="pi")
z_before[10:20]<-4
z_before[120:135]<-6
#plot(y~x,pch=col=c(rep(1,times=33),rep(2,times=33),rep(3,times=34)),main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Estimates by R")
83*3
z_before[280:290]<-4
#plot(y~x,pch=col=c(rep(1,times=33),rep(2,times=33),rep(3,times=34)),main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Estimates by R")
z_before[280:290]<-4
#plot(y~x,pch=col=c(rep(1,times=33),rep(2,times=33),rep(3,times=34)),main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Estimates by R")
83*2
z_before[280:290]<-5
#plot(y~x,pch=col=c(rep(1,times=33),rep(2,times=33),rep(3,times=34)),main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Estimates by R")
z_before[190:200]<-2
#plot(y~x,pch=col=c(rep(1,times=33),rep(2,times=33),rep(3,times=34)),main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Estimates by R")
83*4
z_before[360:370]<-6
#plot(y~x,pch=col=c(rep(1,times=33),rep(2,times=33),rep(3,times=34)),main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Estimates by R")
z_before[450:460]<-1
par(mfrow=c(1,1))
#plot(y~x,pch=col=c(rep(1,times=33),rep(2,times=33),rep(3,times=34)),main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Estimates by R")
write.table(z_before,file="z_before.csv",sep=",",col.names=FALSE,row.names = FALSE)
par(mfrow=c(1,1))
#plot(y~x,pch=col=c(rep(1,times=33),rep(2,times=33),rep(3,times=34)),main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Before MCMC")
###Results after MCMC###
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:6]))
gammas<-as.numeric(unlist(coefs[,7:11]))
sigmas<-exp(logsigma_sqs)
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
P<-read.csv("P.csv",header=FALSE)
x_new<-read.csv("x_new.csv",header=FALSE)
betas_mat<-matrix(betas,ncol=2,nrow=6,byrow=TRUE)
par(mfrow=c(1,1))
plot(y~x,col=z_after,pch=20,main="After MCMC")
for(i in 1:nrow(betas_mat)){
lines(x, betas_mat[i,1]+betas_mat[i,2]*x,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x+2*sqrt(sigmas[i]),lty=2,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x-2*sqrt(sigmas[i]),lty=2,col=i)
}
par(mfrow=c(1,1))
plot(x_new[,2],P[nrow(P),],main="Predictions",ylab="Predicted value",xlab="x new")
data<-read.csv("data_sin2.csv")
y<-data[,1]
X<-data[,2:3]
x<-data[,3]
m1<-lm(y[1:83]~x[1:83])
m2<-lm(y[84:167]~x[84:167])
m3<-lm(y[168:250]~x[168:250])
m4<-lm(y[251:333]~x[251:333])
m6<-lm(y[417:500]~x[417:500])
m5<-lm(y[334:416]~x[334:416])
m1<-lm(y[1:125]~x[1:125])
m2<-lm(y[126:250]~x[126:250])
m3<-lm(y[251:375]~x[251:375])
m4<-lm(y[376:500]~x[376:500])
m1<-lm(y[1:90]~x[1:90])
m2<-lm(y[91:250]~x[91:250])
m3<-lm(y[251:410]~x[251:410])
m4<-lm(y[411:500]~x[411:500])
z_before<-c(rep(1,times=83),rep(2,times=83),rep(3,times=83),
rep(4,times=83),rep(5,times=84),rep(6,times=84))
z_before[10:20]<-4
z_before[120:135]<-6
z_before[190:200]<-2
z_before[280:290]<-5
z_before[360:370]<-6
z_before[450:460]<-1
z_before<-c(rep(1,times=90),rep(2,times=160),
rep(3,times=160),rep(4,times=90))
write.table(z_before,file="z_before.csv",sep=",",col.names=FALSE,row.names = FALSE)
par(mfrow=c(1,1))
#plot(y~x,pch=col=c(rep(1,times=33),rep(2,times=33),rep(3,times=34)),main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Before MCMC")
z_before<-c(rep(1,times=83),rep(2,times=83),rep(3,times=83),
rep(4,times=83),rep(5,times=84),rep(6,times=84))
write.table(z_before,file="z_before.csv",sep=",",col.names=FALSE,row.names = FALSE)
par(mfrow=c(1,1))
#plot(y~x,pch=col=c(rep(1,times=33),rep(2,times=33),rep(3,times=34)),main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Before MCMC")
###Results after MCMC###
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:6]))
gammas<-as.numeric(unlist(coefs[,7:11]))
sigmas<-exp(logsigma_sqs)
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
P<-read.csv("P.csv",header=FALSE)
x_new<-read.csv("x_new.csv",header=FALSE)
betas_mat<-matrix(betas,ncol=2,nrow=6,byrow=TRUE)
par(mfrow=c(1,1))
plot(y~x,col=z_after,pch=20,main="After MCMC")
i<-2
lines(x, betas_mat[i,1]+betas_mat[i,2]*x,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x+2*sqrt(sigmas[i]),lty=2,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x-2*sqrt(sigmas[i]),lty=2,col=i)
i<-3
lines(x, betas_mat[i,1]+betas_mat[i,2]*x,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x+2*sqrt(sigmas[i]),lty=2,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x-2*sqrt(sigmas[i]),lty=2,col=i)
i<-6
lines(x, betas_mat[i,1]+betas_mat[i,2]*x,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x+2*sqrt(sigmas[i]),lty=2,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x-2*sqrt(sigmas[i]),lty=2,col=i)
data<-read.csv("data_sin2.csv")
data<-read.csv("data_sin3.csv")
data<-read.csv("data_sin2.csv")
y<-data[,1]
X<-data[,2:3]
x<-data[,3]
m1<-lm(y[1:125]~x[1:125])
m2<-lm(y[126:250]~x[126:250])
m3<-lm(y[251:375]~x[251:375])
m4<-lm(y[376:500]~x[376:500])
m1<-lm(y[1:90]~x[1:90])
m2<-lm(y[91:250]~x[91:250])
m3<-lm(y[251:410]~x[251:410])
m4<-lm(y[411:500]~x[411:500])
z_before<-c(rep(1,times=90),rep(2,times=160),
rep(3,times=160),rep(4,times=90))
write.table(z_before,file="z_before.csv",sep=",",col.names=FALSE,row.names = FALSE)
par(mfrow=c(1,1))
#plot(y~x,pch=col=c(rep(1,times=33),rep(2,times=33),rep(3,times=34)),main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Estimates by R")
plot(y~x,pch=20,col=z_before,main="Before MCMC")
abline(m1)
abline(m2,col=2)
abline(m3,col=3)
abline(m4,col=4)
abline(m5,col=5)
plot(y~x,pch=20,col=z_before,main="Before MCMC")
###Results after MCMC###
coefs<-read.csv("coefs.csv",header = FALSE)
coefs
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:6]))
gammas<-as.numeric(unlist(coefs[,7:11]))
sigmas<-exp(logsigma_sqs)
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
P<-read.csv("P.csv",header=FALSE)
x_new<-read.csv("x_new.csv",header=FALSE)
betas_mat<-matrix(betas,ncol=2,nrow=6,byrow=TRUE)
par(mfrow=c(1,1))
plot(y~x,col=z_after,pch=20,main="After MCMC")
for(i in 1:nrow(betas_mat)){
lines(x, betas_mat[i,1]+betas_mat[i,2]*x,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x+2*sqrt(sigmas[i]),lty=2,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x-2*sqrt(sigmas[i]),lty=2,col=i)
}
plot(y~x,col=z_after,pch=20,main="After MCMC")
plot(y~x,pch=20,col=z_before,main="Before MCMC")
###Results after MCMC###
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:6]))
gammas<-as.numeric(unlist(coefs[,7:11]))
betas <-as.numeric(unlist(coefs[,1:4]))
sigmas<-exp(logsigma_sqs)
###Results after MCMC###
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:6]))
betas <-as.numeric(unlist(coefs[,1:4]))
gammas<-as.numeric(unlist(coefs[,5:7]))
sigmas<-exp(logsigma_sqs)
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
P<-read.csv("P.csv",header=FALSE)
x_new<-read.csv("x_new.csv",header=FALSE)
betas_mat<-matrix(betas,ncol=2,nrow=6,byrow=TRUE)
par(mfrow=c(1,1))
plot(y~x,col=z_after,pch=20,main="After MCMC")
for(i in 1:nrow(betas_mat)){
lines(x, betas_mat[i,1]+betas_mat[i,2]*x,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x+2*sqrt(sigmas[i]),lty=2,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x-2*sqrt(sigmas[i]),lty=2,col=i)
}
par(mfrow=c(1,1))
betas_mat
###Results after MCMC###
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:4]))
betas
betas_mat<-matrix(betas,ncol=2,nrow=6,byrow=TRUE)
betas_mat<-matrix(betas,ncol=2,nrow=4,byrow=TRUE)
par(mfrow=c(1,1))
plot(y~x,col=z_after,pch=20,main="After MCMC")
for(i in 1:nrow(betas_mat)){
lines(x, betas_mat[i,1]+betas_mat[i,2]*x,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x+2*sqrt(sigmas[i]),lty=2,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x-2*sqrt(sigmas[i]),lty=2,col=i)
}
par(mfrow=c(1,1))
plot(y~x,col=z_after,pch=20,main="After MCMC")
for(i in 2:nrow(betas_mat)){
lines(x, betas_mat[i,1]+betas_mat[i,2]*x,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x+2*sqrt(sigmas[i]),lty=2,col=i)
lines(x, betas_mat[i,1]+betas_mat[i,2]*x-2*sqrt(sigmas[i]),lty=2,col=i)
}
