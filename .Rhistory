if(f >= exp(-3)){
v = f
n = n + 1
}else break
}
N[j] = n
}
N
}
## 4
set.seed(3)
Nsamp = sampleN(20000)
mean(Nsamp == 3)
setwd("C:/Users/Ivona Voroneckaja/Desktop/Consulting Work/Inspiring Scoland/OFN master data.csv")
setwd("C:/Users/Ivona Voroneckaja/Desktop/Consulting Work/Inspiring Scoland")
data<-read.csv("OFN master data.csv")
names(data)
?subset
data_sub<-split(data,data$Full.Name)
View(data_sub)
data_sub[[1]]
data_sub[[1]][,1:6]
nrow(data_sub[[1]][,1:6])
data_org<-split(data,data$Account.Name)
apply(data_org[[1]],1,is.na())
apply(data_org[[1]],1,sum(is.na()))
data_org[[1]]
View(data)
data<-read.csv("OFN master data.csv", na.strings=c("","NA"))
View(data)
data_sub<-split(data,data$Full.Name)
data_org<-split(data,data$Account.Name)
###Number of missing values in each organisation
data_org[[1]]
###Number of missing values in each organisation
is.na(data_org[[1]])
###Number of missing values in each organisation
sum(is.na(data_org[[1]]))
sapply(data_org, fuction(x) sum(is.na(x)))
sapply(data_org, fuction(x){sum(is.na(x))})
sapply(data_org, fuction(x){sum(is.na(x))})
sapply(data_org, function(x){sum(is.na(x))})
###Number of missing values in each organisation
sapply(data_org, function(x){sum(is.na(x))})
###Number of missing values in each organisation
sort(sapply(data_org, function(x){sum(is.na(x))}))
names(data)
###Number of missing values in each organisation
sort(sapply(data_org, function(x){sum(is.na(x[,1:60]))}))
###Number of missing values in each organisation
sort(sapply(data_org, function(x){sum(is.na(x[,1:60]))/(nrow(x)*60)}))
###Number of missing values in each organisation
sort(sapply(data_org, function(x){sum(is.na(x[,1:60]))/(nrow(x)*60)*100}))
nrow(x)*60)*100
data_first<-split(data,data$Record.Type)
View(data_first)
###Look at each variable for new engagement
data_first["New Engagement"]
###Look at each variable for new engagement
new_eng<-data_first["New Engagement"]
summary(new_eng$Gender)
View(new_eng)
###Look at each variable for new engagement
new_eng<-data_first[["New Engagement"]]
summary(new_eng$Gender)
N_new_eng <- nrow(new_eng)
summary(new_eng$Gender)/N_new_eng
#Has gender changed
summary(new_eng$Has.Gender.Changed.From.Birth..)
#Has gender changed
summary(new_eng$Has.Gender.Changed.From.Birth..)/N_new_eng
#Sexuality
summary(data$Sexuality)/N_new_eng
#Has gender changed
sum(summary(new_eng$Has.Gender.Changed.From.Birth..)/N_new_eng)
sum(summary(data$Sexuality)/N_new_eng)
#Sexuality
summary(new_eng$Sexuality)/N_new_eng
#Age
summary(new_eng$Age)/N_new_eng
#Age
summary(new_eng$Age)
hist(new_eng$Age)
sort(age,decreasing = TRUE)
sort(new_eng$Age,decreasing = TRUE)
hist(new_eng$Age[new_eng$Age<100])
#Ethnicity
table(new_eng$Ethnicity)
barchart(new_eng$Ethnicity)
barplot(new_eng$Ethnicity)
barplot(new_eng$Ethnicity)
barplot(table(new_eng$Ethnicity))
barplot(table(new_eng$Ethnicity), cex.names=0.8)
barplot(table(new_eng$Ethnicity), cex.names=0.2)
barplot(table(new_eng$Ethnicity), cex.names=0.2,horizontal=TRUE)
barplot(table(new_eng$Ethnicity), cex.names=0.2,horizontal=TRUE)
barplot(table(new_eng$Ethnicity), cex.names=0.2,horiz=TRUE)
barplot(table(new_eng$Ethnicity), cex.names=0.2)
barplot(table(new_eng$Ethnicity), cex.names=0.5)
barplot(table(new_eng$Ethnicity), cex.names=0.8)
#First Language
table(new_eng$First.Language)
barplot(table(new_eng$First.Language), cex.names=0.8)
#Second Language
table(new_eng$Second.Language)
barplot(table(Second.Language), cex.names=0.8)
barplot(table(new_eng$Second.Language), cex.names=0.8)
#Third Language
table(new_eng$Third.Language)
barplot(table(new_eng$Third.Language), cex.names=0.8)
unique(new_eng$First.Language)
unique(data$First.Language)
###Tidying up
languages<-unique(data$First.Language)
languages
head(languages)
setwd("C:/Users/Ivona Voroneckaja/Desktop/Consulting Work/Inspiring Scoland")
data<-read.csv("OFN master data.csv", na.strings=c("","NA","<NA>"))
names(data)
data_sub<-split(data,data$Full.Name)
data_org<-split(data,data$Account.Name)
data_first<-split(data,data$Record.Type)
###Tidying up
languages<-unique(data$First.Language)
head(languages)
sort(languages)
for(i in 1:nrow(data)){
if(data$First.Language[i]=="african")data$First.Language[i]="African"
if(data$First.Language[i]=="arabic"|data$First.Language[i]=="ARABIC")data$First.Language[i]="Arabic"
}
for(i in 1:nrow(data)){
if(data$First.Language[i]=="african") data$First.Language[i]="African"
if(data$First.Language[i]=="arabic"|data$First.Language[i]=="ARABIC")data$First.Language[i]="Arabic"
}
i=1
data$First.Language[i]=="african"
data$First.Language[i]
which(data$First.Language="african")
which(data$First.Language=="african")
i<-417
data$First.Language[i]=="african"
if(data$First.Language[i]=="african") data$First.Language[i]="African"
if(data$First.Language[i]=="african") data$First.Language[i]<-"African"
data$First.Language[i]<-"African"
class(data$First.Language)
languages
languages["African"]
setwd("C:/Users/Ivona Voroneckaja/Desktop/Consulting Work/Inspiring Scoland")
data<-read.csv("OFN master data.csv", na.strings=c("","NA","<NA>"))
data_sub<-split(data,data$Full.Name)
data_org<-split(data,data$Account.Name)
data_first<-split(data,data$Record.Type)
###Tidying up
languages<-unique(data$First.Language)
languages
sort(languages)
###Tidying up
languages<-sort(unique(data$First.Language))
which(data$First.Language=="Engilish")
which(data$First.Language=="E")
setwd("C:/Users/Ivona Voroneckaja/Desktop/Consulting Work/Inspiring Scoland")
data<-read.csv("OFN master data.csv", na.strings=c("","NA","<NA>"))
###Tidying up
languages<-sort(unique(data$First.Language))
languages
###Tidying up
languages<-sort(unique(data$First.Language))
languages
setwd("C:/Users/Ivona Voroneckaja/Desktop/Consulting Work/Inspiring Scoland")
data<-read.csv("OFN master data.csv", na.strings=c("","NA","<NA>"))
###Tidying up
languages<-sort(unique(data$First.Language))
languages
setwd("C:/Users/Ivona Voroneckaja/Desktop/Consulting Work/Inspiring Scoland")
data<-read.csv("OFN master data.csv", na.strings=c("","NA","<NA>"))
###Tidying up
languages<-sort(unique(data$First.Language))
languages
setwd("C:/Users/Ivona Voroneckaja/Desktop/Consulting Work/Inspiring Scoland")
data<-read.csv("OFN master data.csv", na.strings=c("","NA","<NA>"))
###Tidying up
languages<-sort(unique(data$First.Language))
###Tidying up
languages
setwd("C:/Users/Ivona Voroneckaja/Desktop/Consulting Work/Inspiring Scoland")
data<-read.csv("OFN master data.csv", na.strings=c("","NA","<NA>"))
###Tidying up
languages<-sort(unique(data$First.Language))
languages
data_org<-split(data,data$Account.Name)
data_first<-split(data,data$Record.Type)
###Number of missing values in each organisation
sort(sapply(data_org, function(x){sum(is.na(x[,1:60]))/(nrow(x)*60)*100}))
###Tidying up
languages<-sort(unique(data$First.Language))
###Look at each variable for new engagement
new_eng   <- data_first[["New Engagement"]]
N_new_eng <- nrow(new_eng)
#Gender
summary(new_eng$Gender)/N_new_eng
#Has gender changed
summary(new_eng$Has.Gender.Changed.From.Birth..)/N_new_eng
#Sexuality
summary(new_eng$Sexuality)/N_new_eng
#Age
summary(new_eng$Age)
hist(new_eng$Age[new_eng$Age<100])
#Ethnicity
table(new_eng$Ethnicity)
barplot(table(new_eng$Ethnicity), cex.names=0.8)
table(new_eng$Ethnicity)/N_new_eng
sort(table(new_eng$Ethnicity)/N_new_eng)
languages
new_eng$First.Language=="Lithuanian"
sum(new_eng$First.Language=="Lithuanian",na.omit=TRUE)
sum(new_eng$First.Language=="Lithuanian",rm.na=TRUE)
is.na(new_eng$First.Language)
#Second Language
table(new_eng$Second.Language)
barplot(table(new_eng$Second.Language), cex.names=0.8)
#Third Language
table(new_eng$Third.Language)
barplot(table(new_eng$Third.Language), cex.names=0.8)
#Ethnicity
table(new_eng$Ethnicity)
ethnicities<-sort(unique(data$Ethnicity))
ethnicities
#Referral route
table(new_eng$Referral.Route)
hist(new_eng$Referral.Route)
hist(table(new_eng$Referral.Route))
barplot(table(new_eng$Referral.Route))
#How Positive was School Experience
summary(new_eng$How.Positive.was.School.Experience)
hist(new_eng$How.Positive.was.School.Experience)
#Suffered Bullying at School
table(new_eng$Suffered.Bullying.at.School)
#Ever Been Excluded From School
table(new_eng$Ever.Been.Excluded.From.School)
#Ever Skipped Classes
table(new_eng$Ever)
#Ever Skipped Classes
table(new_eng$Ever.Skipped.Classes)
#Classes Skipped Per Week %
summary(new_eng$Classes.Skipped.Per.Week..)
#How supported in school?
summary(new_eng$How.supported.in.school.)
#How supported in school?
hist(new_eng$How.supported.in.school.)
#When shut off from school
hist(table(new_eng$When.shut.off.from.school))
table(new_eng$When.shut.off.from.school)
#When shut off from school
barchart(table(new_eng$When.shut.off.from.school))
#When shut off from school
barplot(table(new_eng$When.shut.off.from.school))
#Offficially left school
barplot(table(new_eng$Offficially.left.school))
#Current situation
barplot(table(new_eng$Current.situation))
#Current situation
levels(new_eng$Current.situation)
#Wage if working
summary(new_eng$Wage.if.working)
#Wage if working
barplot(table(new_eng$Wage.if.working))
#Zero hours?
barplot(table(new_eng$Zero.hours.contract.))
#Benefits
barplot(table(new_eng$Benefits.state.support))
#Benefits
levels(table(new_eng$Benefits.state.support))
#Benefits
levels(new_eng$Benefits.state.support)
#Living in a workless household?
barplot(table(new_eng$Living.in.a.workless.household.))
#Living in a multi-family household?
barplot(table(new_eng$Living.in.a.multi.family.household.))
#House overcrowded
barplot(table(new_eng$House.overcrowded.))
#Sleep in your own bed?
barplot(table(new_eng$Sleep.in.your.own.bed.))
#Parent?
barplot(table(new_eng$Are.you.a.parent.))
#Current qulifications
barplot(table(new_eng$Any.current.qualifications))
levels(new_eng$Any.current.qualifications)
#Previous participation
barplot(table(new_eng$Previous.participation))
#Previous participation
levels(new_eng$Previous.participation)
#Previous participation with other portfo
barplot(table(new_eng$Previous.participation.with.other.portfo))
#Driving license
barplo(table(new_eng$Driving.licence.))
#Driving license
barplot(table(new_eng$Driving.licence.))
#Bariers
levels(new_eng$Barriers)
#Bariers
levels(new_eng$Barriers)
#Bariers
###too many combinations###
#Have you/your family ever
levels(new_eng$Have.you.your.family.ever.)
#General well-being
hist(new_eng$General.wellbeing.happiness.rating)
#Extent feels safe
hist(new_eng$Extent.YP.feels.safe)
#...healthy
hist(new_eng$Extent.YP.feels.healthy)
#...acheiving
hist(new_eng$Extent.YP.feels.they.are.achieving)
#...nurtured
hist(new_eng$Extent.YP.feels.nurtured)
#...active
hist(new_eng$Extent.YP.feels.active)
#...respected
hist(new_eng$Extent.YP.feels.respected)
#...responsible
hist(new_eng$Extent.YP.feels.responsible)
#...included
hist(new_eng$Extent.YP.feels.included)
#Number of ACES exposed to
hist(new_eng$Number.of.ACES.exposed.to)
new_eng$Number.of.ACES.exposed.to
#Number of ACES exposed to
table(new_eng$Number.of.ACES.exposed.to)
#Ongoing support situation
table(new_eng$Ongoing.support.situation)
#Ongoing support situation
barplot(table(new_eng$Ongoing.support.situation))
#Types of support provided NEEDS FORMATTING
#Engagement hours pw
table(new_eng$Engagement.Hours.Per.Week)
#Life events since NEEDS FORMATTING
#Extent YP has demonstrated resilience
table(new_eng$Extent.YP.has.demonstrated.resilience)
#Life events since NEEDS FORMATTING
#Extent YP has demonstrated resilience
hist(new_eng$Extent.YP.has.demonstrated.resilience)
new_eng$Extent.YP.has.demonstrated.resilience
sum(!is.na(new_eng$Extent.YP.has.demonstrated.resilience))
setwd("C:/Users/Ivona Voroneckaja/Desktop/Consulting Work/Inspiring Scoland")
data<-read.csv("OFN master data.csv", na.strings=c("","NA","<NA>"))
names(data)
data_sub<-split(data,data$Full.Name)
data_org<-split(data,data$Account.Name)
data_first<-split(data,data$Record.Type)
###Number of missing values in each organisation
sort(sapply(data_org, function(x){sum(is.na(x[,1:60]))/(nrow(x)*60)*100}))
###Tidying up
languages<-sort(unique(data$First.Language))
ethnicities<-sort(unique(data$Ethnicity))
###Look at each variable for new engagement
new_eng   <- data_first[["New Engagement"]]
N_new_eng <- nrow(new_eng)
#Life events since NEEDS FORMATTING
#Extent YP has demonstrated resilience ###NOONE HAS ENTERED ANYTHING
hist(new_eng$Extent.YP.has.demonstrated.resilience)
hist(new_eng$Extent.YP.has.demonstrated.aspiration)
hist(new_eng$Extent.YP.has.demonstrated.motivation)
hist(new_eng$Extent.YP.has.demonstrated.self.belief)
hist(new_eng$Extent.YP.has.demonstrated.personal.resp)
hist(new_eng$Extent.YP.has.demonstrated.well.being)
###Destination
table(new_eng$Destination.achieved)
levels(data$Record.Type)
###Destination look at the end, not the initial contact
onging<-data_first[["Ongoing Contact & Support"]]
###Destination look at the end, not the initial contact
ongoing<-data_first[["Ongoing Contact & Support"]]
table(ongoing$Destination)
table(ongoing$Destination.achieved)
data_sub[[200]]
ceased<-ongoing<-data_first[["Contact Ceased"]]
table(ceased$Destination.achieved)
rm(list=ls())
setwd("C:/Users/Ivona Voroneckaja/Desktop/MoE/MoE")
data<-read.csv("data_sin_stand.csv",header = FALSE)
y<-data[,1]
X<-data[,2:3]
x<-data[,3]
z_before<-read.csv("z_before.csv",header=FALSE)
z_before<-z_before[,1]
plot(x,y,col=z_before,pch=20, main="Starting point")
abline(lm(y[z_before==1]~x[z_before==1]))
abline(lm(y[z_before==2]~x[z_before==2]),col=2)
z_afterMCMC<-read.csv("z_MCMCRJ.csv",header=FALSE)
z_afterMCMC<-z_afterMCMC[,1]
plot(x,y,col=z_afterMCMC,pch=20, main="After RJ MCMC")
z1<-z_afterMCMC
z_afterMCMC<-read.csv("z_MCMCRJ.csv",header=FALSE)
z_afterMCMC<-z_afterMCMC[,1]
plot(x,y,col=z_afterMCMC,pch=20, main="After RJ MCMC")
z2<-z_afterMCMC
z_afterMCMC<-read.csv("z_MCMCRJ.csv",header=FALSE)
z_afterMCMC<-z_afterMCMC[,1]
plot(x,y,col=z_afterMCMC,pch=20, main="After RJ MCMC")
z3<-z_afterMCMC
###AFTER RJ MCMC##
z_before<-read.csv("z_before.csv",header=FALSE) #case 1
z_before<-z_before[,1]
plot(x,y,col=z_before,pch=20, main="Starting point")
z_afterMCMC<-read.csv("z_MCMCRJ.csv",header=FALSE)
z_afterMCMC<-z_afterMCMC[,1]
plot(x,y,col=z_afterMCMC,pch=20, main="After RJ MCMC")
z1<-z_afterMCMC
params<-read.csv("all_params.csv")
params
params<-read.csv("all_params.csv",header=FALSE)
params
n_exp=length(unique(z_afterMCMC))
n_exp
for(i in 1:n_exp){
lines(x,params[1,i]+params[2,i]*x)
}
cols=unique(z_afterMCMC)
lines(x,params[1,i]+params[2,i]*x,col=cols[i])
for(i in 1:n_exp){
lines(x,params[1,i]+params[2,i]*x,col=cols[i])
}
cols
for(i in 1:n_exp){
lines(x,params[1,i]+params[2,i]*x)
}
n_exp<-length(unique(z_afterMCMC))
cols<-c(1,2,4)
params<-read.csv("all_params.csv",header=FALSE)
for(i in 1:n_exp){
lines(x,params[1,i]+params[2,i]*x)
}
z1<-z_afterMCMC
for(i in 1:n_exp){
lines(x,params[1,i]+params[2,i]*x,col=cols[i])
}
par(mfrow=c(1,2))
plot(x,y,col=z_before,pch=20, main="Starting point")
plot(x,y,col=z_afterMCMC,pch=20, main="After RJ MCMC")
for(i in 1:n_exp){
lines(x,params[1,i]+params[2,i]*x,col=cols[i])
}
z_before<-read.csv("z_for_merge.csv",header=FALSE) #case 2
plot(x,y,col=z_before,pch=20, main="Starting point")
z_before<-z_before[,1]
plot(x,y,col=z_before,pch=20, main="Starting point")
plot(x,y,col=z_before,pch=20, main="Starting point")
z_afterMCMC<-read.csv("z_MCMCRJ.csv",header=FALSE)
z_afterMCMC<-z_afterMCMC[,1]
plot(x,y,col=z_afterMCMC,pch=20, main="After RJ MCMC")
n_exp<-length(unique(z_afterMCMC))
cols<-c(1,2,3) #case 2
params<-read.csv("all_params.csv",header=FALSE)
for(i in 1:n_exp){
lines(x,params[1,i]+params[2,i]*x,col=cols[i])
}
z_before<-read.csv("z_4exp_merge.csv",header=FALSE) #case 3
z_before<-z_before[,1]
plot(x,y,col=z_before,pch=20, main="Starting point")
z_afterMCMC<-read.csv("z_MCMCRJ.csv",header=FALSE)
z_afterMCMC<-z_afterMCMC[,1]
plot(x,y,col=z_afterMCMC,pch=20, main="After RJ MCMC")
cols<-c(1,3,4) #case 3
params<-read.csv("all_params.csv",header=FALSE)
for(i in 1:n_exp){
lines(x,params[1,i]+params[2,i]*x,col=cols[i])
}
x1<-rnorm(n=100,mean=5,sd=1)
x2<-rnorm(n=100,mean=2,sd=1)
y<-x1+x2
plot(y)
plot(x1,y)
plot(x2,y)
set.seed(5)
x1<-rnorm(n=100,mean=5,sd=1)
x2<-rnorm(n=100,mean=2,sd=1)
y<-x1+x2
plot(x1,y)
plot(x2,y)
plot(x1,y)
plot(x1,y)
plot(x2,y)
set.seed(5)
x1<-rnorm(n=100,mean=5,sd=1)
x2<-rnorm(n=100,mean=2,sd=1)
y<-x1+x2
plot(x1,y)
plot(x2,y)
write.table(cbind(y,x1,x2),"two_x.csv",row.names = FALSE,col.names = FALSE)
write.table(cbind(y,x1,x2),"two_x.csv",sep=",",row.names = FALSE,col.names = FALSE)
write.table(cbind(y,1,x1,x2),"two_x.csv",sep=",",row.names = FALSE,col.names = FALSE)
hist(y)
set.seed(5)
x1<-rnorm(n=100,mean=-5,sd=1)
x2<-rnorm(n=100,mean=2,sd=1)
y<-x1+x2
hist(y)
plot(x1,y)
plot(x2,y)
set.seed(5)
x1<-rnorm(n=100,mean=-5,sd=1)
x2<-rnorm(n=100,mean=20,sd=1)
y<-x1+x2
hist(y)
set.seed(5)
x1<-rnorm(n=100,mean=5,sd=1)
x2<-rnorm(n=100,mean=20,sd=1)
y<-x1+x2
plot(x1,y)
plot(x2,y)
write.table(cbind(y,1,x1,x2),"two_x.csv",sep=",",row.names = FALSE,col.names = FALSE)
430/8
