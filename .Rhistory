z_split
###After split###
par(mfrow=c(1,1))
plot(y~x,col=z_split,pch=20,main="1000 MCMC Iterations")
gamma_new<-read.csv("gamma_new.csv")
gamma_new
gamma_new<-read.csv("gamma_new.csv",header=FALSe)
gamma_new<-read.csv("gamma_new.csv",header=FALSE)
gamma_new
class(gamma_new)
gamma_new<-as.numeric(read.csv("gamma_new.csv",header=FALSE))
gamma_new<-as.numeric(unlist(read.csv("gamma_new.csv",header=FALSE)))
gamma_new
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*120-10,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*120-10,lty=4,col="darkgreen")
lines(x,exp(gamma_new[1]+gamma_new[2]*x)/(1+exp(gamma_new[1]+gamma_new[2]*x))*120-10,lty=2,col=4)
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*2-10,lty=2,col=4)
###After split###
par(mfrow=c(1,1))
plot(y~x,col=z_split,pch=20,main="1000 MCMC Iterations")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*2-10,lty=2,col=4)
exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*2-1,lty=2,col=4)
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*3-1,lty=2,col=4)
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1,lty=2,col=4)
###After split###
par(mfrow=c(1,1))
plot(y~x,col=z_split,pch=20,main="1000 MCMC Iterations")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*3-1,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*3-1,lty=4,col="darkgreen")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*3-2,lty=2,col=4)
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*3-1.5,lty=2,col=4)
plot(y~x,col=z_split,pch=20,main="After gate split")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*3-1.5,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*3-1.5,lty=4,col="darkgreen")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1.5,lty=2,col=4)
###After split###
par(mfrow=c(1,1))
plot(y~x,col=z_split,pch=20,main="After gate split")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1.5,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*4-1.5,lty=4,col="darkgreen")
lines(x,exp(gamma_new[1]+gamma_new[2]*x)/(1+exp(gamma_new[1]+gamma_new[2]*x))*4-1.5,lty=2,col=3)
plot(y~x,col=z_after,pch=20,main="1000 MCMC Iterations")
plot(y~x,col=z_after,pch=20,main="1000 MCMC Iterations")
plot(y~x,col=z_split,pch=20,main="After gate split")
z_split
z_split[1:20]
z_after
z_after==1
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
z_after
sum(z_after==1)
par(mfrow=c(1,1))
plot(y~x,col=z_after,pch=20,main="1000 MCMC Iterations")
plot(y~x,col=z_split,pch=20,main="After gate split")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1.5,lty=2,col=4)
###Results after MCMC###
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:3]))
gammas<-as.numeric(unlist(coefs[,4:5]))
plot(y~x,col=z_split,pch=20,main="After gate split")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1.5,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*4-1.5,lty=4,col="darkgreen")
lines(x,exp(gamma_new[1]+gamma_new[2]*x)/(1+exp(gamma_new[1]+gamma_new[2]*x))*4-1.5,lty=2,col=3)
x_record<-as.numeric(unlist(read.csv("x_record.csv",header=FALSE)))
x_record
###After split###
y_chosen<-y[x==x_record[1]]
y_chosen
points(x_record[1],y_chosen,pch=21)
points(x_record[1],y_chosen,pch=21,col=8)
points(x_record[1],y_chosen,pch=21,col=10)
points(x_record[1],y_chosen,pch=15,col=10)
points(x_record[1],y_chosen,pch=15,col=5)
points(x_record[1],y_chosen,pch=15,col=6)
points(x_record[2],y_chosen,pch=15,col=18)
points(x_record[2],y_chosen,pch=18,col=7)
points(x_record[2],y_chosen,pch=18,col=8)
points(x_record[1],y_chosen,pch=15,col=6)
points(x_record[2],y_chosen,pch=18,col=1)
points(x_record[2],y_chosen,pch=17,col=1)
plot(y~x,col=z_split,pch=20,main="After gate split")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1.5,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*4-1.5,lty=4,col="darkgreen")
lines(x,exp(gamma_new[1]+gamma_new[2]*x)/(1+exp(gamma_new[1]+gamma_new[2]*x))*4-1.5,lty=2,col=3)
points(x_record[1],y_chosen,pch=15,col=6)
points(x_record[2],y_chosen,pch=17,col=1)
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:3]))
gammas<-as.numeric(unlist(coefs[,4:5]))
gamma_new<-as.numeric(unlist(read.csv("gamma_new.csv",header=FALSE)))
sigmas<-exp(logsigma_sqs)
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
z_split<-read.csv("z_afterSplit.csv",header=FALSE)
z_split<-z_split[,1]
P<-read.csv("P.csv",header=FALSE)
x_new<-read.csv("x_new.csv",header=FALSE)
x_record<-as.numeric(unlist(read.csv("x_record.csv",header=FALSE)))
par(mfrow=c(1,1))
plot(y~x,col=z_after,pch=20,main="1000 MCMC Iterations")
par(mfrow=c(1,1))
plot(x_new[,2],colMeans(P[200:nrow(P),]),main="Average Predictions",ylab="Predicted value",xlab="x new")
matplot(x_new[,2],t(P[seq(from=200,to=nrow(P),length=50),]),type="l",main="Average Predictions",ylab="Predicted value",xlab="x new")
par(mfrow=c(1,2))
plot(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x)),type="l",main="Gate 1",ylab="pi")
plot(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x)),type="l",main="Gate 2",ylab="pi")
par(mfrow=c(1,1))
plot(y~x,col=z_after,pch=20,main="1000 MCMC Iterations")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*120-10,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*120-10,lty=4,col="darkgreen")
###After split###
y_chosen<-y[x==x_record[1]]
par(mfrow=c(1,1))
plot(y~x,col=z_split,pch=20,main="After gate split")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1.5,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*4-1.5,lty=4,col="darkgreen")
lines(x,exp(gamma_new[1]+gamma_new[2]*x)/(1+exp(gamma_new[1]+gamma_new[2]*x))*4-1.5,lty=2,col=3)
points(x_record[1],y_chosen,pch=15,col=6)
points(x_record[2],y_chosen,pch=17,col=1)
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:3]))
gammas<-as.numeric(unlist(coefs[,4:5]))
gamma_new<-as.numeric(unlist(read.csv("gamma_new.csv",header=FALSE)))
sigmas<-exp(logsigma_sqs)
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
z_split<-read.csv("z_afterSplit.csv",header=FALSE)
z_split<-z_split[,1]
P<-read.csv("P.csv",header=FALSE)
x_new<-read.csv("x_new.csv",header=FALSE)
x_record<-as.numeric(unlist(read.csv("x_record.csv",header=FALSE)))
###After split###
y_chosen<-y[x==x_record[1]]
par(mfrow=c(1,1))
plot(y~x,col=z_split,pch=20,main="After gate split")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1.5,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*4-1.5,lty=4,col="darkgreen")
lines(x,exp(gamma_new[1]+gamma_new[2]*x)/(1+exp(gamma_new[1]+gamma_new[2]*x))*4-1.5,lty=2,col=3)
points(x_record[1],y_chosen,pch=15,col=6)
points(x_record[2],y_chosen,pch=17,col=1)
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:3]))
gammas<-as.numeric(unlist(coefs[,4:5]))
gamma_new<-as.numeric(unlist(read.csv("gamma_new.csv",header=FALSE)))
sigmas<-exp(logsigma_sqs)
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
z_split<-read.csv("z_afterSplit.csv",header=FALSE)
z_split<-z_split[,1]
P<-read.csv("P.csv",header=FALSE)
x_new<-read.csv("x_new.csv",header=FALSE)
x_record<-as.numeric(unlist(read.csv("x_record.csv",header=FALSE)))
par(mfrow=c(1,1))
plot(y~x,col=z_after,pch=20,main="1000 MCMC Iterations")
###After split###
y_chosen<-y[x==x_record[1]]
par(mfrow=c(1,1))
plot(y~x,col=z_split,pch=20,main="After gate split")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1.5,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*4-1.5,lty=4,col="darkgreen")
lines(x,exp(gamma_new[1]+gamma_new[2]*x)/(1+exp(gamma_new[1]+gamma_new[2]*x))*4-1.5,lty=2,col=3)
points(x_record[1],y_chosen,pch=15,col=6)
points(x_record[2],y_chosen,pch=17,col=1)
###After Swap###
z_swap<-read.csv("z_swap.csv",header=FALSE)
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:3]))
gammas<-as.numeric(unlist(coefs[,4:5]))
gamma_new<-as.numeric(unlist(read.csv("gamma_new.csv",header=FALSE)))
sigmas<-exp(logsigma_sqs)
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
z_split<-read.csv("z_afterSplit.csv",header=FALSE)
z_split<-z_split[,1]
P<-read.csv("P.csv",header=FALSE)
x_new<-read.csv("x_new.csv",header=FALSE)
x_record<-as.numeric(unlist(read.csv("x_record.csv",header=FALSE)))
par(mfrow=c(1,1))
plot(y~x,col=z_after,pch=20,main="1000 MCMC Iterations")
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:3]))
gammas<-as.numeric(unlist(coefs[,4:5]))
gamma_new<-as.numeric(unlist(read.csv("gamma_new.csv",header=FALSE)))
sigmas<-exp(logsigma_sqs)
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
z_split<-read.csv("z_afterSplit.csv",header=FALSE)
z_split<-z_split[,1]
P<-read.csv("P.csv",header=FALSE)
x_new<-read.csv("x_new.csv",header=FALSE)
x_record<-as.numeric(unlist(read.csv("x_record.csv",header=FALSE)))
par(mfrow=c(1,1))
plot(y~x,col=z_after,pch=20,main="1000 MCMC Iterations")
plot(y~x,col=z_after,pch=20,main="1000 MCMC Iterations")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1.5,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*4-1.5,lty=4,col="darkgreen")
###After split###
y_chosen<-y[x==x_record[1]]
par(mfrow=c(1,1))
plot(y~x,col=z_split,pch=20,main="After gate split")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1.5,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*4-1.5,lty=4,col="darkgreen")
lines(x,exp(gamma_new[1]+gamma_new[2]*x)/(1+exp(gamma_new[1]+gamma_new[2]*x))*4-1.5,lty=2,col=3)
points(x_record[1],y_chosen,pch=15,col=6)
points(x_record[2],y_chosen,pch=17,col=1)
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:3]))
gammas<-as.numeric(unlist(coefs[,4:5]))
gamma_new<-as.numeric(unlist(read.csv("gamma_new.csv",header=FALSE)))
sigmas<-exp(logsigma_sqs)
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
z_split<-read.csv("z_afterSplit.csv",header=FALSE)
z_split<-z_split[,1]
P<-read.csv("P.csv",header=FALSE)
x_new<-read.csv("x_new.csv",header=FALSE)
x_record<-as.numeric(unlist(read.csv("x_record.csv",header=FALSE)))
par(mfrow=c(1,1))
plot(y~x,col=z_after,pch=20,main="1000 MCMC Iterations")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1.5,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*4-1.5,lty=4,col="darkgreen")
###After split###
y_chosen<-y[x==x_record[1]]
par(mfrow=c(1,1))
plot(y~x,col=z_split,pch=20,main="After gate split")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1.5,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*4-1.5,lty=4,col="darkgreen")
lines(x,exp(gamma_new[1]+gamma_new[2]*x)/(1+exp(gamma_new[1]+gamma_new[2]*x))*4-1.5,lty=2,col=3)
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:3]))
gammas<-as.numeric(unlist(coefs[,4:5]))
gamma_new<-as.numeric(unlist(read.csv("gamma_new.csv",header=FALSE)))
sigmas<-exp(logsigma_sqs)
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
z_split<-read.csv("z_afterSplit.csv",header=FALSE)
z_split<-z_split[,1]
P<-read.csv("P.csv",header=FALSE)
x_new<-read.csv("x_new.csv",header=FALSE)
x_record<-as.numeric(unlist(read.csv("x_record.csv",header=FALSE)))
par(mfrow=c(1,1))
plot(y~x,col=z_after,pch=20,main="1000 MCMC Iterations")
lines(x, betas[1]+betas[2]*x)
lines(x, betas[1]+betas[2]*x+2*sqrt(sigmas[1]),lty=2)
lines(x, betas[1]+betas[2]*x-2*sqrt(sigmas[1]),lty=2)
lines(x, betas[3]+betas[4]*x+2*sqrt(sigmas[2]),lty=2,col=2)
lines(x, betas[3]+betas[4]*x,col=2)
lines(x, betas[3]+betas[4]*x-2*sqrt(sigmas[2]),lty=2,col=2)
lines(x, betas[5]+betas[6]*x,col=3)
lines(x, betas[5]+betas[6]*x+2*sqrt(sigmas[3]),lty=2,col=3)
lines(x, betas[5]+betas[6]*x-2*sqrt(sigmas[3]),lty=2,col=3)
par(mfrow=c(1,1))
plot(x_new[,2],colMeans(P[200:nrow(P),]),main="Average Predictions",ylab="Predicted value",xlab="x new")
matplot(x_new[,2],t(P[seq(from=200,to=nrow(P),length=50),]),type="l",main="Average Predictions",ylab="Predicted value",xlab="x new")
par(mfrow=c(1,2))
plot(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x)),type="l",main="Gate 1",ylab="pi")
plot(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x)),type="l",main="Gate 2",ylab="pi")
par(mfrow=c(1,1))
plot(y~x,col=z_after,pch=20,main="1000 MCMC Iterations")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1.5,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*4-1.5,lty=4,col="darkgreen")
###After split###
y_chosen<-y[x==x_record[1]]
par(mfrow=c(1,1))
plot(y~x,col=z_split,pch=20,main="After gate split")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1.5,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*4-1.5,lty=4,col="darkgreen")
lines(x,exp(gamma_new[1]+gamma_new[2]*x)/(1+exp(gamma_new[1]+gamma_new[2]*x))*4-1.5,lty=2,col=3)
points(x_record[1],y_chosen,pch=15,col=6)
points(x_record[2],y_chosen,pch=17,col=1)
###After Swap###
z_swap<-read.csv("z_swap.csv",header=FALSE)
###Results after MCMC###
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:3]))
gammas<-as.numeric(unlist(coefs[,4:5]))
gamma_new<-as.numeric(unlist(read.csv("gamma_new.csv",header=FALSE)))
sigmas<-exp(logsigma_sqs)
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
z_split<-read.csv("z_afterSplit.csv",header=FALSE)
z_split<-z_split[,1]
P<-read.csv("P.csv",header=FALSE)
x_new<-read.csv("x_new.csv",header=FALSE)
x_record<-as.numeric(unlist(read.csv("x_record.csv",header=FALSE)))
###After split###
y_chosen<-y[x==x_record[1]]
par(mfrow=c(1,1))
plot(y~x,col=z_split,pch=20,main="After gate split")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1.5,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*4-1.5,lty=4,col="darkgreen")
lines(x,exp(gamma_new[1]+gamma_new[2]*x)/(1+exp(gamma_new[1]+gamma_new[2]*x))*4-1.5,lty=2,col=3)
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:3]))
gammas<-as.numeric(unlist(coefs[,4:5]))
gamma_new<-as.numeric(unlist(read.csv("gamma_new.csv",header=FALSE)))
sigmas<-exp(logsigma_sqs)
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
z_split<-read.csv("z_afterSplit.csv",header=FALSE)
z_split<-z_split[,1]
P<-read.csv("P.csv",header=FALSE)
x_new<-read.csv("x_new.csv",header=FALSE)
x_record<-as.numeric(unlist(read.csv("x_record.csv",header=FALSE)))
###After split###
y_chosen<-y[x==x_record[1]]
par(mfrow=c(1,1))
plot(y~x,col=z_split,pch=20,main="After gate split")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1.5,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*4-1.5,lty=4,col="darkgreen")
lines(x,exp(gamma_new[1]+gamma_new[2]*x)/(1+exp(gamma_new[1]+gamma_new[2]*x))*4-1.5,lty=2,col=3)
points(x_record[1],y_chosen,pch=15,col=6)
points(x_record[2],y_chosen,pch=17,col=1)
###After Swap###
z_swap<-read.csv("z_swap.csv",header=FALSE)
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:3]))
gammas<-as.numeric(unlist(coefs[,4:5]))
gamma_new<-as.numeric(unlist(read.csv("gamma_new.csv",header=FALSE)))
sigmas<-exp(logsigma_sqs)
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
z_split<-read.csv("z_afterSplit.csv",header=FALSE)
z_split<-z_split[,1]
P<-read.csv("P.csv",header=FALSE)
x_new<-read.csv("x_new.csv",header=FALSE)
x_record<-as.numeric(unlist(read.csv("x_record.csv",header=FALSE)))
y_chosen<-y[x==x_record[1]]
par(mfrow=c(1,1))
plot(y~x,col=z_split,pch=20,main="After gate split")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1.5,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*4-1.5,lty=4,col="darkgreen")
lines(x,exp(gamma_new[1]+gamma_new[2]*x)/(1+exp(gamma_new[1]+gamma_new[2]*x))*4-1.5,lty=2,col=3)
points(x_record[1],y_chosen,pch=15,col=6)
points(x_record[2],y_chosen,pch=17,col=1)
###Results after MCMC###
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:3]))
gammas<-as.numeric(unlist(coefs[,4:5]))
gamma_new<-as.numeric(unlist(read.csv("gamma_new.csv",header=FALSE)))
sigmas<-exp(logsigma_sqs)
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
z_split<-read.csv("z_afterSplit.csv",header=FALSE)
z_split<-z_split[,1]
P<-read.csv("P.csv",header=FALSE)
x_new<-read.csv("x_new.csv",header=FALSE)
x_record<-as.numeric(unlist(read.csv("x_record.csv",header=FALSE)))
y_chosen<-y[x==x_record[1]]
par(mfrow=c(1,1))
plot(y~x,col=z_split,pch=20,main="After gate split")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1.5,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*4-1.5,lty=4,col="darkgreen")
lines(x,exp(gamma_new[1]+gamma_new[2]*x)/(1+exp(gamma_new[1]+gamma_new[2]*x))*4-1.5,lty=2,col=3)
points(x_record[1],y_chosen,pch=15,col=6)
points(x_record[2],y_chosen,pch=17,col=1)
###After Swap###
###Results after MCMC###
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:3]))
gammas<-as.numeric(unlist(coefs[,4:5]))
gamma_new<-as.numeric(unlist(read.csv("gamma_new.csv",header=FALSE)))
sigmas<-exp(logsigma_sqs)
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
z_split<-read.csv("z_afterSplit.csv",header=FALSE)
z_split<-z_split[,1]
P<-read.csv("P.csv",header=FALSE)
x_new<-read.csv("x_new.csv",header=FALSE)
x_record<-as.numeric(unlist(read.csv("x_record.csv",header=FALSE)))
###After split###
y_chosen<-y[x==x_record[1]]
par(mfrow=c(1,1))
plot(y~x,col=z_split,pch=20,main="After gate split")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1.5,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*4-1.5,lty=4,col="darkgreen")
lines(x,exp(gamma_new[1]+gamma_new[2]*x)/(1+exp(gamma_new[1]+gamma_new[2]*x))*4-1.5,lty=2,col=3)
points(x_record[1],y_chosen,pch=15,col=6)
points(x_record[2],y_chosen,pch=17,col=1)
x_record[1]
x==x_record[1]
y_chosen
x_record[2]
gamma_new
plot(x,exp(gamma_new[1]+gamma_new[2]*x)/(1+exp(gamma_new[1]+gamma_new[2]*x))*4-1.5,lty=2,col=3)
plot(x,exp(gamma_new[1]+gamma_new[2]*x)/(1+exp(gamma_new[1]+gamma_new[2]*x)),lty=2,col=3)
abline(v=x_record[2])
coefs_new<-read.csv("coefs_new.csv",header = FALSE)
logsigma_sqs_new<-as.numeric(read.csv("sigmas_new.csv",header = FALSE))
coefs_new<-read.csv("coefs_new.csv",header = FALSE)
logsigma_sqs_new<-as.numeric(read.csv("sigmas_new.csv",header = FALSE))
coefs_new<-read.csv("coefs_new.csv",header = FALSE)
logsigma_sqs_new<-as.numeric(read.csv("sigmas_new.csv",header = FALSE))
betas_new <-as.numeric(unlist(coefs_new[,1:4]))
gammas_new<-as.numeric(unlist(coefs_new[,5:7]))
sigmas_new<-exp(logsigma_sqsv_new)
sigmas_new<-exp(logsigma_sq_new)
sigmas_new<-exp(logsigma_sqs_new)
###After split###
y_chosen<-y[x==x_record[1]]
par(mfrow=c(1,1))
plot(y~x,col=z_split,pch=20,main="After gate split")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1.5,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*4-1.5,lty=4,col="darkgreen")
lines(x,exp(gamma_new[1]+gamma_new[2]*x)/(1+exp(gamma_new[1]+gamma_new[2]*x))*4-1.5,lty=2,col=3)
points(x_record[1],y_chosen,pch=15,col=6)
points(x_record[2],y_chosen,pch=17,col=1)
lines(x, betas_new[1]+betas_new[2]*x)
lines(x, betas_new[1]+betas_new[2]*x+2*sqrt(sigmas_new[1]),lty=2)
lines(x, betas_new[1]+betas_new[2]*x-2*sqrt(sigmas_new[1]),lty=2)
lines(x, betas_new[3]+betas_new[4]*x,col=2)
lines(x, betas_new[3]+betas_new[4]*x+2*sqrt(sigmas_new[2]),lty=2,col=2)
lines(x, betas_new[3]+betas_new[4]*x-2*sqrt(sigmas_new[2]),lty=2,col=2)
lines(x, betas_new[5]+betas_new[6]*x,col=3)
lines(x, betas_new[5]+betas_new[6]*x+2*sqrt(sigmas_new[3]),lty=2,col=3)
lines(x, betas_new[5]+betas_new[6]*x-2*sqrt(sigmas_new[3]),lty=2,col=3)
lines(x, betas_new[7]+betas_new[8]*x,col=4)
lines(x, betas_new[7]+betas_new[8]*x+2*sqrt(sigmas_new[4]),lty=2,col=4)
lines(x, betas_new[7]+betas_new[8]*x-2*sqrt(sigmas_new[4]),lty=2,col=4)
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:3]))
gammas<-as.numeric(unlist(coefs[,4:5]))
gamma_new<-as.numeric(unlist(read.csv("gamma_new.csv",header=FALSE)))
sigmas<-exp(logsigma_sqs)
coefs_new<-read.csv("coefs_new.csv",header = FALSE)
logsigma_sqs_new<-as.numeric(read.csv("sigmas_new.csv",header = FALSE))
betas_new <-as.numeric(unlist(coefs_new[,1:4]))
gammas_new<-as.numeric(unlist(coefs_new[,5:7]))
sigmas_new<-exp(logsigma_sqs_new)
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
z_split<-read.csv("z_afterSplit.csv",header=FALSE)
z_split<-z_split[,1]
P<-read.csv("P.csv",header=FALSE)
x_new<-read.csv("x_new.csv",header=FALSE)
x_record<-as.numeric(unlist(read.csv("x_record.csv",header=FALSE)))
###After split###
y_chosen<-y[x==x_record[1]]
par(mfrow=c(1,1))
plot(y~x,col=z_split,pch=20,main="After gate split")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1.5,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*4-1.5,lty=4,col="darkgreen")
lines(x,exp(gamma_new[1]+gamma_new[2]*x)/(1+exp(gamma_new[1]+gamma_new[2]*x))*4-1.5,lty=2,col=3)
points(x_record[1],y_chosen,pch=15,col=6)
points(x_record[2],y_chosen,pch=17,col=1)
lines(x, betas_new[1]+betas_new[2]*x)
lines(x, betas_new[1]+betas_new[2]*x+2*sqrt(sigmas_new[1]),lty=2)
lines(x, betas_new[1]+betas_new[2]*x-2*sqrt(sigmas_new[1]),lty=2)
lines(x, betas_new[3]+betas_new[4]*x,col=2)
lines(x, betas_new[3]+betas_new[4]*x+2*sqrt(sigmas_new[2]),lty=2,col=2)
lines(x, betas_new[3]+betas_new[4]*x-2*sqrt(sigmas_new[2]),lty=2,col=2)
lines(x, betas_new[5]+betas_new[6]*x,col=3)
lines(x, betas_new[5]+betas_new[6]*x+2*sqrt(sigmas_new[3]),lty=2,col=3)
lines(x, betas_new[5]+betas_new[6]*x-2*sqrt(sigmas_new[3]),lty=2,col=3)
lines(x, betas_new[7]+betas_new[8]*x,col=4)
lines(x, betas_new[7]+betas_new[8]*x+2*sqrt(sigmas_new[4]),lty=2,col=4)
lines(x, betas_new[7]+betas_new[8]*x-2*sqrt(sigmas_new[4]),lty=2,col=4)
coefs<-read.csv("coefs.csv",header = FALSE)
logsigma_sqs<-as.numeric(read.csv("sigmas.csv",header = FALSE))
betas <-as.numeric(unlist(coefs[,1:3]))
gammas<-as.numeric(unlist(coefs[,4:5]))
gamma_new<-as.numeric(unlist(read.csv("gamma_new.csv",header=FALSE)))
sigmas<-exp(logsigma_sqs)
coefs_new<-read.csv("coefs_new.csv",header = FALSE)
logsigma_sqs_new<-as.numeric(read.csv("sigmas_new.csv",header = FALSE))
betas_new <-as.numeric(unlist(coefs_new[,1:4]))
gammas_new<-as.numeric(unlist(coefs_new[,5:7]))
sigmas_new<-exp(logsigma_sqs_new)
z_after<-read.csv("z_afterMCMC.csv",header=FALSE)
z_after<-z_after[,1]
z_split<-read.csv("z_afterSplit.csv",header=FALSE)
z_split<-z_split[,1]
P<-read.csv("P.csv",header=FALSE)
x_new<-read.csv("x_new.csv",header=FALSE)
x_record<-as.numeric(unlist(read.csv("x_record.csv",header=FALSE)))
###After split###
y_chosen<-y[x==x_record[1]]
par(mfrow=c(1,1))
plot(y~x,col=z_split,pch=20,main="After gate split")
lines(x,exp(gammas[1]+gammas[2]*x)/(1+exp(gammas[1]+gammas[2]*x))*4-1.5,lty=2,col=4)
lines(x,exp(gammas[3]+gammas[4]*x)/(1+exp(gammas[3]+gammas[4]*x))*4-1.5,lty=4,col="darkgreen")
lines(x,exp(gamma_new[1]+gamma_new[2]*x)/(1+exp(gamma_new[1]+gamma_new[2]*x))*4-1.5,lty=2,col=3)
points(x_record[1],y_chosen,pch=15,col=6)
points(x_record[2],y_chosen,pch=17,col=1)
lines(x, betas_new[1]+betas_new[2]*x)
lines(x, betas_new[1]+betas_new[2]*x+2*sqrt(sigmas_new[1]),lty=2)
lines(x, betas_new[1]+betas_new[2]*x-2*sqrt(sigmas_new[1]),lty=2)
lines(x, betas_new[3]+betas_new[4]*x,col=2)
lines(x, betas_new[3]+betas_new[4]*x+2*sqrt(sigmas_new[2]),lty=2,col=2)
lines(x, betas_new[3]+betas_new[4]*x-2*sqrt(sigmas_new[2]),lty=2,col=2)
lines(x, betas_new[5]+betas_new[6]*x,col=3)
lines(x, betas_new[5]+betas_new[6]*x+2*sqrt(sigmas_new[3]),lty=2,col=3)
lines(x, betas_new[5]+betas_new[6]*x-2*sqrt(sigmas_new[3]),lty=2,col=3)
lines(x, betas_new[7]+betas_new[8]*x,col=4)
lines(x, betas_new[7]+betas_new[8]*x+2*sqrt(sigmas_new[4]),lty=2,col=4)
lines(x, betas_new[7]+betas_new[8]*x-2*sqrt(sigmas_new[4]),lty=2,col=4)
